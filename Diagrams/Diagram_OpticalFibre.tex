\documentclass[crop,tikz]{standalone}

\usepackage[utf8]{inputenc}
% 'crop' is the default for v1.0, before it was 'preview'
%\usetikzlibrary{...}% tikz package already loaded by 'tikz' option
\usetikzlibrary{decorations.markings}

\input{../Preamble/PreambleMaths.tex}

%so as to be consistent with the photonic fibre picture, make sure that the image is no greater than a 5\times 5 size (plus text to one side I guess)

\begin{document}

\begin{tikzpicture}
	%core, cladding, and casing plus labels
	\filldraw[fill=black!10!white, draw=black] (0,0) circle (3);       	
	\filldraw[fill=black!30!white, draw=black] (0,0) circle (2.5);
	\filldraw[fill=black!0!white, draw=black] (0,0) circle (1);
	\node[anchor=center] at (0,0) {Fibre core};
	\node[anchor=center] at (0,1.5) {Fibre cladding};
	\draw[red] (-2.2,1.75) -- (-3.5,2.5);
	\node[anchor=east, align=center] at (-3.5,2.5) {Protective \\ casing};
	%box to illustrate that this is the cross-section
	\draw[dashed] (-3,-3) rectangle (3,3);
	\draw[dashed] (-3,-3) -- (0,-4.4);
	\draw[dashed] (3,-3) -- (0,-4.4);
	\node[anchor=north, align=center] at (0,-3) {Cross-sectional view};

	%propagation mechanism, casing
	\begin{scope}[shift={(0,-1)}]
		\filldraw[fill=black!10!white, draw=black] (-5.5,-3.4) rectangle (0,-3.5);
		\filldraw[fill=black!30!white, draw=black] (-5.5,-3.5) rectangle (0,-3.7);
		\filldraw[fill=black!0!white, draw=black] (-5.5,-3.7) rectangle (0,-4.1);
		\filldraw[fill=black!30!white, draw=black] (-5.5,-4.1) rectangle (0,-4.3);
		\filldraw[fill=black!10!white, draw=black] (-5.5,-4.3) rectangle (0,-4.4);
		%light ray (yRange is -3.7 to -4.1), length is 5.5
		\begin{scope}[decoration={markings, mark=at position 0.5 with {\arrow{>>}}}]
			\draw[red, postaction=decorate] (0,-3.8) -- (-1.5,-4.1);
			\draw[red, postaction=decorate] (-1.5,-4.1) -- (-5,-3.7);
			\draw[red, postaction=decorate] (-5,-3.7) -- (-5.5,-3.8);
		\end{scope}
		%light ray labels
		\node[red, anchor=west, align=center] at (0,-3.9) {Light propagation \\ (ray in red)};
		%TIR points
		\draw[black] (-1.5,-4.1) -- (-4.5,-2.5);
		\draw[black] (-5,-3.7) -- (-4.5,-2.5);
		\node[anchor=south, align=center] at (-4.5,-2.5) {Total Internal \\  Reflections};
		%fibre axis for clarity
		\draw[->, thick] (-1.25, -4.6) -- (-3,-4.6) node[anchor=north west] {Fibre axis};
	\end{scope}

\end{tikzpicture}

\end{document}