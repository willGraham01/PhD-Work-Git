\section{Concepts from the Study of Quantum/Metric Graphs} \label{sec:QuantumGraphs}
Before we present a derivation of the system \eqref{eq:QGFullSystem} from the measure-theoretic problem \eqref{eq:PeriodCellLaplaceStrongForm}, we first need to formally introduce the objects involved in each.
To this end, in this section we cover the theory we need to borrow from the field of Quantum Graphs, and also setup our notation for graphs throughout this work.
We include an outline of what is meant be an embedded graph in section \ref{ssec:EmbeddedGraphs}, in order to provide a concrete foundation for the phrase ``periodic graph" which represents the geometry of our (physically-motivated) singular structure.
We then define the function spaces one works in when dealing with a Quantum Graph problem, as well as an overview of the $M$-matrix, which is a tool that will be vital when determining the spectrum of the problem \eqref{eq:QGFullSystem}.
Although the concept of a singular measure is needed to formally link \eqref{eq:PeriodCellLaplaceStrongForm} and \eqref{eq:QGFullSystem}, these details are left to the appendix (section \ref{ssec:SingularMeasures}) as the focus of this work is analysis and determination of the spectrum of \eqref{eq:QGFullSystem} rather than it's derivation. \newline

We begin with the definition of a quantum (or more generally, metric) graph.
Let $\graph=\bracs{\vertSet,\edgeSet}$ be a directed graph with vertices $v_j\in \vertSet$ and edges $I_{jk}=\bracs{v_j, v_k}\in \edgeSet$, where $I_{jk}$ is directed from vertex $v_j$ (``on the left") to vertex $v_k$ (``on the right").
Strictly we should use the notation $I_{jk}^l$ for the edges; with $l$ being a script which runs from $1$ to the number of edges with left endpoint $v_j$ and right endpoint $v_k$, as in general there may be multiple such connections from $v_j$ to $v_k$.
However we drop this superscript to avoid notational clutter, and because it's inclusion is not necessary to understand the concepts we introduce here.
Each edge $I_{jk}$ is assigned a length $l_{jk}>0$ and interval $\sqbracs{0,l_{jk}}$, which we also denote by $I_{jk}$ (for reasons that will become apparent shortly).
We also assign each vertex $v_j$ a ``coupling constant" $\alpha_j\in\complex$ (although in our examples we will only be considering $\alpha_j\in\reals$).
A graph $\graph$ with the metric structure described above is called a \emph{quantum graph}, or \emph{metric graph}. \tstk{cite Kuchment by page/chapter, also check Kuchment book whether we need to include the operator in the definition too!}

\subsection*{Periodic Graphs embedded in the Plane} \label{ssec:EmbeddedGraphs}
We say a (directed) graph $\graph = \bracs{\vertSet,\edgeSet}$ is embedded into $\reals^2$ if each vertex $v_j$ is associated to a point which we also label $v_j\in\reals^2$; and each edge $I_{jk}$ associated to a curve $\gamma_{jk}\subset\reals^2$ with (arc-)length $l_{jk}$, such that there is a continuous map
\begin{align} \label{eq:GeneralCurveParam}
	r: \sqbracs{0,l_{jk}} \rightarrow \gamma_{jk}, \quad r(0) = v_j, \quad r\bracs{l_{jk}} = v_k.
\end{align}
Again, we will drop the distinction between $I_{jk}$ and $\gamma_{jk}$, simply using $I_{jk}$ for both.
Clearly, an embedded graph gives rise to a quantum graph, and a quantum graph can be used to construct embedded graphs.
The choice of $\reals^2$ is simply to cover the situations we will be considering in this work, there are more general definitions depending on the choice of space to ``embed" the graph into.
For a unit vector $x\in\reals^2$, an embedded graph is said to be $T$-periodic in the direction $x$ if it is invariant under the translation $Tx$ applied to its vertices and edges.
In what follows, we always refer to the minimal such $T>0$ (``period") with this property for a given $x\in\reals^2$.
Note that so long as the graph $\graph$ is periodic in two linearly independent directions, a linear transform can be applied to transform the period cell of $\graph$ into a rectangle with sides parallel to the co-ordinate axes, and so without loss of generality we only consider rectangular period cells henceforth.
If $\graph$ is periodic in the (orthogonal) axial directions $e_1, e_2$ (with periods $T_1, T_2$ respectively), then we can define the ``period cell" or ``unit cell" $\mathcal{P}$ of $\graph$ in the obvious manner: take the intersection of the graph $\graph$ with the region $\mathcal{P} = \sqbracs{0,T_1}\times\sqbracs{0,T_2}$ and match the left boundary to the right, and top boundary to the bottom.
That is, view the part $\graph_{\mathcal{P}}$ of the graph $\graph$ contained in the region $\mathcal{P}$ as a set on a torus, see \ref{fig:PeriodCellIllustration}.
\begin{figure}[b!]
	\centering
	\begin{subfigure}[t]{0.45\textwidth}
		\centering
		\includegraphics[height=4.5cm]{Diagram_PeriodCellFullLattice.pdf}
		\caption{\label{fig:Diagram_PeriodCellFullLattice} A periodic graph embedded into $\reals^2$, with the period cell marked.}
	\end{subfigure}
	~
	\begin{subfigure}[t]{0.45\textwidth}
		\centering
		\includegraphics[height=4.5cm]{Diagram_PeriodCellEdgeAssociation.pdf}
		\caption{\label{fig:Diagram_PeriodCellEdgeAssociation} The period cell of the graph in \ref{fig:Diagram_PeriodCellFullLattice}, notice how the edges of the period cell are associated.}
	\end{subfigure}
	\\
	\begin{subfigure}[b]{0.75\textwidth}
		\centering
		\includegraphics[scale=	1.0]{Diagram_PeriodCellOnTorus.pdf}
		\caption{\label{fig:Diagram_PeriodCellOnTorus} An illustration of the period cell as a subset of a torus.}
	\end{subfigure}
	\caption{\label{fig:PeriodCellIllustration} Illustrating a periodic cell of a periodic embedded graph.}
\end{figure} 
We will refer to $\graph_{\mathcal{P}} = \graph \cap \mathcal{P}$ as the ``period graph", or ``unit graph" of $\graph$. \newline

For the remainder of this work, we restrict ourselves to the consideration of graphs with straight edges, although the analysis in the appendix (\tstk{ref}) does include the case of curved edges being present in the graph.
Allowing for the possibility of curved edges gives rise to a system of a similar form to \eqref{eq:QGFullSystem} only with the parameters $\qm_{jk}$ being $t$-dependant (so non-constant).
\tstk{paper on ``dipole ops" mention here, and essentially conclude that this would require a different treatment to what we are covering in this paper. That said, we still did it, and it's in the back if anyone WANTS to read it!}
We formalise this assumption in the following convention, to clearly detail the assumptions we make for the remainder of the this work:
\begin{convention} \label{conv:MeasTheoryProblemSetup}
	Let $\graph=\bracs{\vertSet,\edgeSet}$ be the period graph of an embedded graph in $\reals^2$ with period cell $\ddom$, so $\graph\subset\ddom$.
	We restrict ourselves to considering straight-edges between vertices, so each $I_{jk}\in \edgeSet$ is the line segment joining the vertices at either end, with lengths $l_{jk} = \abs{I_{jk}} = \norm{v_j-v_k}_2$.
	Let $e_{jk}$ be the unit vector parallel to $I_{jk}$ and directed from $v_j$ to $v_k$.
	Set
	\begin{align} \label{eq:EdgeParameterisation}
	r_{jk}:\sqbracs{0, l_{jk}} \ni t \mapsto v_j + te_{jk} \in I_{jk},
	\end{align}
	and note that $r_{jk}'(t) = e_{jk}$.
	Finally, let $n_{jk}$ be the unit normal to $I_{jk}$ such that $y_{jk} = \bracs{e_{jk}, n_{jk}}$ can be obtained by an orthonormal rotation $R_{jk}\in\mathrm{SO}(2)$ of the (canonical) axis vectors $x = \bracs{x_1, x_2}$, formally by $x = R_{jk}y_{jk}$.
\end{convention}

\subsection{Function Spaces} \label{ssec:FunctionSpaces}
By providing each edge with a length and hence associating it with an interval, we can construct functions on quantum graphs by describing their behaviour on the edges, and hence can produce the function spaces
\begin{subequations} \label{eq:GraphFuncSpaces}
	\begin{align}
		L^2\bracs{\graph} := \bigoplus_{I_{jk}\in \edgeSet} \ltwo{I_{jk}}{t},
		&\quad H^1\bracs{\graph} := \bigoplus_{I_{jk}\in \edgeSet} \gradSob{I_{jk}}{t}, \\
		H^2\bracs{\graph} := \bigoplus_{I_{jk}\in \edgeSet} H^2_\mathrm{grad}\bracs{I_{jk}, \md t}. &
	\end{align}
\end{subequations}
We define $u_{jk} = u\vert_{I_{jk}}$ to be the restriction of a function $u$ defined on $\graph$ to the edge $I_{jk}$, extended by zero.
As the directed edge $I_{jk}$ is associated to the interval $\sqbracs{0,l_{jk}}$, we will also use the shorthand
\begin{align*}
	u_{jk}\bracs{v_j} &= u_{jk}\bracs{0}, &\quad
	u_{jk}\bracs{v_k} = u_{jk}\bracs{l_{jk}}, \\
	u_{kj}\bracs{v_j} &= u_{kj}\bracs{l_{kj}}, &\quad
	u_{kj}\bracs{v_k} = u_{kj}\bracs{0}.
\end{align*}
If $u$ is continuous at a vertex $v_j$, we will use the notation $u\bracs{v_j}$ for this value.
This will be convenient later, when we work with quantum graphs that have been obtained from graphs embedded in $\reals^2$.
We also require a notion of ``signed derivative" (which is analogous to the ``normal derivative" for PDE problems) for our functions when we approach the endpoints of an edge in the graph $\graph$.
To this end, we adopt the following convention;
\begin{subequations} \label{eq:SignedDerivConvention}
	\begin{align}
		\diff{}{t}u_{jk}\bracs{v_j} &= -u_{jk}'\bracs{v_j} = -\lim_{t\rightarrow0}u_{jk}'(t), \\
		\diff{}{t}u_{jk}\bracs{v_k} &= u_{jk}'\bracs{v_k} = \lim_{t\rightarrow l_{jk}}u_{jk}'(t),
	\end{align}
\end{subequations}
for suitably differentiable functions $u$ on $\graph$. 
In effect the formulae \eqref{eq:SignedDerivConvention} define an ``exterior facing" derivative at each endpoint. \newline
 
Before we discuss differential operators on quantum graphs we introduce some notation to make the equations more readable: $j\conLeft k$ stands for ``an edge with endpoints $v_j$ and $v_k$, with $v_j$ on the left", and $j\con k$ is used to mean ``an edge with endpoints $v_j$ and $v_k$", for use in cases where we do not care about the direction of the connection.
We also use $j \conRight k$ which can be read as meaning $k\conLeft j$, that is ``an edge with endpoints $v_j$ and $v_k$, with $v_j$ on the right".
Formally we have
\begin{align*}
	j\conLeft k &\Leftrightarrow I_{jk}\in \edgeSet, \\
	j\con k &\Leftrightarrow I_{jk}\in \edgeSet \text{ or } I_{kj}\in \edgeSet.
\end{align*}
We can then utilise this notation as shorthand in summations involving edges or vertices in the following manner; for a fixed $j$
\begin{align*}
	\sum_{j\conLeft k} = \sum_{\substack{k \\ I_{jk}\in \edgeSet}}, \quad
	\sum_{j\conRight k} = \sum_{\substack{k \\ I_{kj}\in \edgeSet}}.
\end{align*}
Furthermore, for a fixed $j$ we use the notation
\begin{align*}
	\sum_{j\con k} = \sum_{j\conLeft k} + \sum_{j\conRight k},
\end{align*}
so for example
\begin{align*}
	\sum_{j\con k}u_{jk}\bracs{v_j} &= \sum_{j\conLeft k}u_{jk}\bracs{v_j} + \sum_{j\conRight }u_{kj}\bracs{v_j}.
\end{align*}
For consistency with the possibility of having multiple edges $I_{jk}^l$ connecting two vertices, then these sums should be interpreted as being over all such edges (that is, running over $k$ and the appropriate range of $l$). \newline

Differential operators on quantum graphs can then be defined by specifying their domains and their action on each edge of the graph $\graph$.
A well-posed problem on a graph requires specifying boundary conditions at the vertices, which are identified with the end-points of the corresponding edges $I_{jk}$.
Specifying these ``boundary conditions" or ``vertex conditions" also reflects the connectivity of the graph (which the function spaces \eqref{eq:GraphFuncSpaces} do not convey on their own).
There are a variety of choices one can make for the vertex conditions, and we will be interested in imposing continuity of the solution at each vertex, and a Robin-like condition on the derivatives of the solution.
Such conditions are also referred to as ``$\delta-$type " conditions \tstk{refs to Abelviero et al (exactly solvable) and Berkolainko-Kuchment}.
By way of example, let us demonstrate how we define the graph Laplacian $\mathcal{A}$.
The domain of $\mathcal{A}$ is defined as
\begin{align*}
	\mathrm{dom}\mathcal{A} &= \clbracs{ u\in H^2\bracs{\graph} \ \vert \ \forall j, \ u \text{ is continuous at } v_j, \sum_{j\con k}\diff{u_{jk}}{t}\bracs{v_j} = \alpha_j u\bracs{v_j} },
\end{align*}
and the differential expression on each edge is $-\ddiff{}{t}$.
Then for a function $f\in L^2\bracs{\graph}$ we can pose the resolvent problem of finding $u\in\mathrm{dom}\mathcal{A}$ such that
\begin{align*}
	\mathcal{A}u &= f;
\end{align*}
or alternatively can consider the spectral problem of finding eigenpairs $\bracs{\lambda,u}\in\complex\times\mathrm{dom}\mathcal{A}$ such that
\begin{align*}
	\mathcal{A}u &= \lambda u.
\end{align*}
Each of these problems can be rewritten as a system of ODEs on the edge intervals coupled through the vertex conditions;
\begin{align*}
	\mathcal{A}u = f \quad\Leftrightarrow\quad &
	\begin{cases}
		-\ddiff{u_{jk}}{t} = f_{jk} \ \forall j\conLeft k, \\
		\forall j, \ u \text{ is continuous at } v_j, \\
		\forall j, \sum_{j\con k}\diff{u_{jk}}{t}\bracs{v_j} = \alpha_j u\bracs{v_j}.
	\end{cases} \\
	\mathcal{A}u = \lambda u \quad\Leftrightarrow\quad &
	\begin{cases}
		-\ddiff{u_{jk}}{t} = \lambda u_{jk} \ \forall j\conLeft k, \\
		\forall j, \ u \text{ is continuous at } v_j, \\
		\forall j, \sum_{j\con k}\diff{u_{jk}}{t}\bracs{v_j} = \alpha_j u\bracs{v_j}.
	\end{cases}
\end{align*}

\subsection{The $M$-Matrix} \label{ssec:MMatrix}
When solving spectral problems on quantum graphs, recent developments involving an object known as the $M$-matrix will provide us with a useful tool in determining the spectrum, as we discuss in section \ref{ssec:Derivation}.
The $M$-matrix is in fact a generalisation of the classical Weyl-Titchmarsh $m$-function as it appears in the theory of boundary triples (more information can be found \tstk{refs to Kochuben, Gorbachuk \& Gorbachuk, Brown Marletta Naboko Wood, Kirill Sasha Luis}), however here we restrict ourselves to a short review the specific theory that will be relevant to this work.
Let $\mathcal{A}$ be the graph Laplacian, and define the maps
\begin{align*}
	\dmap, \nmap: \mathrm{dom}\mathcal{A} \rightarrow \complex^{\abs{\vertSet}};
\end{align*}
which send a function $u\in\mathrm{dom}\mathcal{A}$, to its Dirichlet and Neumann data at each of the vertices respectively;
\begin{align*}
	\bracs{\dmap u}_j &= u\bracs{v_j}, \quad &j=1,...,\abs{\vertSet} \\
	\bracs{\nmap u}_j &= \sum_{j\con k}\diff{u_{jk}}{t}\bracs{v_j}, \quad &j=1,...,\abs{\vertSet}. 
\end{align*}
The $M$-matrix is then defined by
\begin{align*}
	\complex^{\abs{\vertSet}} \ni M\bracs{\lambda}\dmap u &= \nmap u \in \complex^{\abs{\vertSet}},
	 &\quad \forall u\in\mathrm{ker}\bracs{\mathcal{A}-\lambda}.
\end{align*}
It can be shown that $\lambda$ is an eigenvalue of $\mathcal{A}$ if and only if
\begin{align*}
	\mathrm{det}\bracs{M\bracs{\lambda} - A}= 0,
\end{align*}
where $A = \mathrm{diag}\bracs{\alpha_1, \alpha_2, ... , \alpha_{\abs{\vertSet}}}$ is the diagonal matrix of the vertex coupling constants.
\tstk{A more general statement can be found in Derkach, Malomund.}
One can see that this effectively reduces a system of ODEs to a matrix eigenvalue problem, at least as far as determining the spectrum is concerned.
We will exploit this fact in section \tstk{ref!}.
