\section{Appendix: Key Measure-Theoretic Concepts} \label{app:MeasureTheory}
In this section we address the question of how one understands the equations \eqref{eq:WholeSpaceLaplaceEqn} and \eqref{eq:PeriodCellLaplaceStrongForm}, by introducing the relevant differential operators and function spaces.
Attempting to pose a boundary-value problem on a singular-structure, by drawing analogy to the ``ingredients" of a boundary-value problem on a thin structure, runs into problems.
These are due to the singular structure lacking a domain interior from the perspective of the space it is embedded in, so the notion of boundary values ceases to make sense.
This issue is resolved by not abandoning what we believe are the ingredients of a boundary-value problem, but rather by reworking our concepts of integration and differentiation so that they respect the fact that we are looking at a problem on the singular structure itself.
As we will be working with each of the measures $\dddmes, \ddmes$, and $\nu$ above individually before combining our knowledge of each, what we present here is stated in terms of a generic measure $\rho$.

Define
\begin{align*}
	W^{\kt}_{\rho,\mathrm{grad}} &:= \overline{\clbracs{ \bracs{\phi, \ktgrad\phi} \setVert \phi\in\smooth{\ddom} }},
\end{align*}
where the closure is taken in $\ltwo{\ddom}{\rho}\times\ltwo{\ddom}{\rho}^3$, and 
\begin{align*}
	W^{\kt}_{\rho,\mathrm{curl}} &:= \overline{\clbracs{ \bracs{\Phi, \ktcurl{}\Phi} \setVert \Phi\in\bracs{\smooth{\ddom}}^3 }},
\end{align*}
where the closure is taken in $\ltwo{\ddom}{\rho}^3\times\ltwo{\ddom}{\rho}^3$.
The idea is to construct an analogy to a Sobolev space for the measure $\rho$, and hence obtain a concept of (weak) derivative.
However notice that if $\bracs{u,g_1}, \bracs{0, g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$ then we also have that $\bracs{u, g_1+g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$, so ``gradients" (in reference to the second element of a pair in $W^{\kt}_{\rho,\mathrm{grad}}$) are not unique --- both $g_1$ and $g_1+g_2$ are ``gradients" of $u$.
A similar result holds for the elements of $W^{\kt}_{\rho,\mathrm{curl}}$.
As such, we define the set of ``$\rho$ gradients of zero" as
\begin{align*}
	\gradZero{\ddom}{\rho} &= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\kt}_\rho,\mathrm{grad}}, \\
	&= \clbracs{ g\in\ltwo{\ddom}{\rho}^3 \setVert \exists\phi_n\in\smooth{\ddom} \text{ s.t. } \phi_n \lconv{\ltwo{\ddom}{\rho}}0, \ktgrad\phi_n\lconv{\ltwo{\ddom}{\rho}^3} g }, \labelthis\label{eq:GradZeroSequenceDef}
\end{align*}
and analogously define the set of ``$\rho$ curls of zero" as
\begin{align*}
	\curlZero{\ddom}{\rho} &= \clbracs{ c\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,c}\in W^{\kt}_\rho,\mathrm{curl}}, \\
	&= \clbracs{ c\in\ltwo{\ddom}{\rho}^3 \setVert \exists\Phi^n\in\smooth{\ddom}^3 \text{ s.t. } \Phi^n\lconv{\ltwo{\ddom}{\rho}^3}0, \ \ktcurl{}\Phi\lconv{\ltwo{\ddom}{\rho}^3} c}. \labelthis\label{eq:CurlZeroSequenceDef}
\end{align*}
The sets $\gradZero{\ddom}{\rho}$ and $\curlZero{\ddom}{\rho}$ do not depend on $\kt$, as the following proposition demonstrates.

\begin{prop} \label{prop:ZeroInvariantUnderQM-Wavenumber}
	Fix $\wavenumber$ and a quasi-momentum $\qm$, and let
	\begin{align*}
		\gradZero{\ddom}{\rho}^{\kt} &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\kt}_\mathrm{grad} }, \\
		\gradZero{\ddom}{\rho} &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\bracs{0, 0}}_\mathrm{grad} }, \\
		\curlZero{\ddom}{\rho}^{\kt} &:= \clbracs{ c\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,c}\in W^{\kt}_\mathrm{curl} }, \\
		\curlZero{\ddom}{\rho} &:= \clbracs{ g\in \ltwo{\ddom}{\rho}^3 \setVert \bracs{0,g}\in W^{\bracs{0, 0}}_\mathrm{curl} }.
	\end{align*}
	Then the following sets are equal:
	\begin{align*}
		\gradZero{\ddom}{\rho}^{\kt} &= \gradZero{\ddom}{\rho}, \\
		\curlZero{\ddom}{\rho}^{\kt} &= \curlZero{\ddom}{\rho}.
	\end{align*}
\end{prop}
\begin{proof}
	This is seen by observing that for $\phi\in\smooth{\ddom}$ and $\Phi\in\smooth{\ddom}^3$,
	\begin{align*}
		\grad^{\kt}\phi &= \grad^{\bracs{0, 0}}\phi + \rmi\wavenumber\begin{pmatrix} 0 \\ 0 \\ \phi \end{pmatrix} + \rmi\begin{pmatrix} \qm_1 \\ \qm_2 \\ 0 \end{pmatrix}\phi, \\
		\grad^{\kt}\wedge\Phi &= \grad^{\bracs{0, 0}}\wedge\Phi + \rmi\wavenumber\begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}\wedge\Phi + \rmi\begin{pmatrix} \qm_1 \\ \qm_2 \\ 0 \end{pmatrix} \wedge \Phi.
	\end{align*}
	Thus, if $g\in \gradZero{\ddom}{\rho}^{\kt}$ there exists a sequence $\phi_n\in\smooth{\ddom}$ such that
	\begin{align*}
		\phi_n \lconv{\ltwo{\ddom}{\rho}} 0, &\quad \ktgrad\phi_n \lconv{ \ltwo{\ddom}{\rho}^3 } g,
	\end{align*}
	(as in \eqref{eq:GradZeroSequenceDef}).
	But $\rmi\bracs{\qm_1, \qm_2, 0}^{\top}\phi_n\rightarrow 0$, as does $\rmi\wavenumber\phi_n$.
	Given the formulae above, we must also have that $\grad^{\bracs{0, 0}}\phi_n\rightarrow g$, so $g\in \gradZero{\ddom}{\rho}^{\bracs{0, 0}}$.
	The reverse implication, and the proof for $\rho$-curls of zero, is similar.
\end{proof}

Clearly $\gradZero{\ddom}{\rho}$ is a closed, linear subspace of $\ltwo{\ddom}{\rho}^3$ and thus we can decompose 
\begin{align*}
	\ltwo{\ddom}{\rho}^3 = \gradZero{\ddom}{\rho}^{\perp} \oplus \gradZero{\ddom}{\rho}.
\end{align*}
Now suppose that we have $\bracs{u,g_1}, \bracs{u,g_2}\in W^{\kt}_{\rho,\mathrm{grad}}$ with $g_1, g_2\in\gradZero{\ddom}{\rho}^\perp$.
This implies there exist smooth functions $\phi_n, \psi_n$ such that
\begin{align*}
	\phi_n \lconv{\ltwo{\ddom}{\rho}} u, &\quad \psi_n \lconv{\ltwo{\ddom}{\rho}} u, \\
	\ktgrad\phi_n \lconv{\ltwo{\ddom}{\rho}^3} g_1, &\quad \ktgrad\psi_n \lconv{\ltwo{\ddom}{\rho}^3} g_2.
\end{align*}
Since $g_1, g_2\in \gradZero{\ddom}{\rho}^{\perp}$, we have that $g_1-g_2\in \gradZero{\ddom}{\rho}^{\perp}$ too.
However, 
\begin{align*}
	\phi_n - \psi_n \lconv{\ltwo{\ddom}{\rho}} 0, &\quad \ktgrad\bracs{\phi_n-\psi_n} \lconv{\ltwo{\ddom}{\rho}^3} g_1 - g_2,
\end{align*}
so $g_1 - g_2\in \gradZero{\ddom}{\rho}$ too --- therefore we must have that $g_1=g_2$.
With this in mind, we see that each $u$ possesses a unique gradient \emph{that is orthogonal to} $\gradZero{\ddom}{\rho}$.
This allows construction of the ``Sobolev space" of gradients with respect to the measure $\rho$:
\begin{definition}[Sobolev Space of Gradients] \label{def:3DGradSobSpace}
	The set
	\begin{align*}
		\ktgradSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktgrad_{\rho}u}\in W^{\kt}_{\rho,\mathrm{grad}} \setVert \ktgrad_{\rho}u \perp \gradZero{\ddom}{\rho} },
	\end{align*}
	is called the ``Sobolev space of $\kt$-gradients with respect to the measure $\rho$".
	We call the member $\ktgrad_{\rho}u$ of the pair $\bracs{u, \ktgrad_{\rho}u}\in\ktgradSob{\ddom}{\rho}$ the ``$\kt$-tangential gradient of $u$ with respect to $\rho$".
\end{definition}
When the context is clear, we will simply refer to $\ktgrad_{\rho}u$ as the ``tangential gradient" or ``$\kt$-tangential gradient.
Additionally, it is enough to specify the first member $u$ of the pair $\bracs{u, \ktgrad_{\rho}u}$ due to the uniqueness of $\kt$-tangential gradients, so we will often write $u\in\ktgradSob{\ddom}{\rho}$ as shorthand.

We can also perform analogous steps for $\curlZero{\ddom}{\rho}$, which allows us to define the ``Sobolev space" of curls with respect to the measure $\rho$:
\begin{definition}[Sobolev Space of Curls] \label{def:CurlSobSpace}
	The set
	\begin{align*}
		\ktcurlSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktcurl{\rho}u}\in W^{\kt}_{\rho,\mathrm{curl}} \setVert \ktcurl{\rho}u \perp \curlZero{\ddom}{\rho} },
	\end{align*}
	is called the ``Sobolev space of $\kt$-curls with respect to the measure $\rho$".
	The member $\ktcurl{\rho}u$ of the pair $\bracs{u, \ktcurl{\rho}u}$ is the ``$kt$-tangential curl of $u$ with respect to $\rho$".
\end{definition}
Like with tangential gradients; we will use $u\in\ktcurlSob{\ddom}{\rho}$ to refer to the element $\bracs{u, \ktcurl{\rho}u}\in\ktcurlSob{\ddom}{\rho}$, since each $u$ has a unique $\ktcurl{\rho}u$ that is orthogonal to $\curlZero{\ddom}{\rho}$, and when the context is clear will refer to $\ktcurl{\rho}u$ as the ``tangential curl" or ``$kt$-tangential curl".

Having provided a notion of ($\kt$-)curl and gradient for the measure $\rho$, we can assign a meaning to the term ``divergence-free".
\begin{definition}[$\kt$-Divergence free] \label{def:ktDivergenceFree}
We say a vector field $u\in\ltwo{\ddom}{\rho}^3$ is $\kt$-divergence free with respect to $\rho$ if 
\begin{align*}
	0 &= \integral{\ddom}{ u\cdot\overline{g} }{\rho}, \qquad\forall \bracs{v,g}\in W^{\kt}_{\rho,\mathrm{grad}}.
\end{align*}
\end{definition}
Intuitively, $u$ is $\kt$-divergence free with respect to $\rho$ if $u$ is orthogonal to all $\kt$-gradients with respect to $\rho$, including both $\kt$-tangential gradients and gradients of zero.

Given the definitions of $\ktcurl{\rho}u$, we can now state precisely what is meant by a solution to an equation such as 
\begin{align} \label{eq:GeneralCurlCurlStrongForm}
	\ktcurl{\rho} \bracs{ \ktcurl{\rho} u } = \omega^2 u.
\end{align}
The statement ``a function $u\in\ktcurlSob{\ddom}{\rho}$ is a solution to the equation \eqref{eq:GeneralCurlCurlStrongForm}" is interpreted as meaning $u\in\ktcurlSob{\ddom}{\rho}$ satisfies
\begin{align*}
	\integral{\ddom}{ \ktcurl{\rho}u \cdot \overline{\ktcurl{\rho}\Phi} }{\rho} &= \omega^2\integral{\ddom}{ u\cdot\overline{\Phi}}{\rho}, \quad\forall\Phi\in\smooth{\ddom}^3.
\end{align*}
To understand how to move from equations such as \eqref{eq:PeriodCellCurlCurlStrongForm} to the formulation \eqref{eq:QGFullSystem}, we must understand the properties of the functions, their gradients, and curls with respect to the measure $\rho$.
This is the focus of appendices \ref{app:3DMuAnalysis}-\ref{app:SumMeasureAnalysis}, where we concern ourselves with the measures $\ddmes, \nu$, and $\dddmes$.

To conclude this section, we provide some simple results which will prove useful throughout our analysis.
First, it is useful to note that functions with tangential curls or gradients can also be approximated by smooth functions.
\begin{cory} \label{cory:SobSpaceApproxSequences}
	\begin{align*}
		\ktgradSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktgrad_{\rho}u} \setVert \exists\phi_n\in\smooth{\ddom} \text{ s.t. } \phi_n\lconv{\ltwo{\ddom}{\rho}}u, \ \ktgrad\phi_n\lconv{\ltwo{\ddom}{\rho}^3}\ktgrad_{\rho}u }, \\
		\ktcurlSob{\ddom}{\rho} &= \clbracs{ \bracs{u, \ktcurl{\rho}u} \setVert \exists\Phi^n\in\smooth{\ddom}^3 \text{ s.t. } \Phi^n\lconv{\ltwo{\ddom}{\rho}^3}u, \ \ktcurl{}\Phi^n\lconv{\ltwo{\ddom}{\rho}^3}\ktgrad_{\rho}u }.
	\end{align*}
\end{cory}
\begin{proof}
	This is a direct consequence of the construction of $W^{\kt}_{\rho,\mathrm{grad}}$ and $W^{\kt}_{\rho,\mathrm{curl}}$.
\end{proof}

Additionally, the rule that ``the curl of a gradient is 0" translates into its natural analogue on $\kt$-tangential curls and gradients.
\begin{prop} \label{prop:CurlOfGradIsZero}
	Suppose that $\bracs{u,\ktgrad_{\rho}u}\in\ktgradSob{\ddom}{\rho}$.
	Then $\bracs{\ktgrad_{\rho}u, 0}\in\ktcurlSob{\ddom}{\rho}$.
\end{prop}
\begin{proof}
	First, let $\phi\in\smooth{\ddom}$, $\Phi = \ktgrad\phi$, and set $\widetilde{\qm} = \bracs{\qm_1, \qm_2, 0}^\top$ throughout.
	Notice that
	\begin{align*}
		\Phi = \ktgrad\phi &= \e^{-\rmi\qm\cdot x}\kgrad\bracs{ \e^{\rmi\qm\cdot x}\phi },
	\end{align*}
	so with $\psi = \e^{\rmi\qm\cdot x}\phi$, we have that
	\begin{align*}
		\ktcurl{}\Phi 
		&= \kgrad\wedge\bracs{ \Phi } + \rmi\widetilde{\qm}\wedge\Phi
		= -\rmi\widetilde{\qm}\wedge\Phi + \e^{-\rmi\qm\cdot x}\kgrad\wedge\psi + \rmi\widetilde{\qm}\wedge\Phi \\
		&= \e^{-\rmi\qm\cdot x}\kgrad\wedge\psi
		= \e^{-\rmi\qm\cdot x} 
		\begin{pmatrix}
			\partial_2\bracs{ \rmi\wavenumber \e^{\rmi\qm\cdot x}\phi } - \rmi\wavenumber\partial_2\bracs{ \e^{\rmi\qm\cdot x}\phi } \\
			\rmi\wavenumber\partial_1\bracs{ \e^{\rmi\qm\cdot x}\phi } - \partial_1\bracs{ \rmi\wavenumber \e^{\rmi\qm\cdot x}\phi } \\
			\partial_1\bracs{ \partial_2\bracs{\rmi\wavenumber\e^{\rmi\qm\cdot x}\phi} } - \partial_2\bracs{ \partial_1\bracs{\rmi\wavenumber\e^{\rmi\qm\cdot x}\phi} }
		\end{pmatrix} \\
		&= 0.
	\end{align*}
	So now suppose that $u\in\ktgradSob{\ddom}{\rho}$, and take an approximating sequence $\phi_n$ for $u$ as in corollary \ref{cory:SobSpaceApproxSequences}.
	By the above calculation, we have that $\ktcurl{}\bracs{\ktgrad\phi_n}=0$ for every $n\in\naturals$, and thus
	\begin{align*}
		\ktgrad\phi_n \lconv{\ltwo{\ddom}{\rho}^3} \ktgrad_{\rho}u, \qquad
		\ktcurl{}\bracs{\ktgrad\phi_n} \lconv{\ltwo{\ddom}{\rho}^3} 0.
	\end{align*}
	Since $0\in\curlZero{\ddom}{\rho}^\perp$, we must conclude that $\bracs{ \ktgrad_{\rho}u, 0 }\in\ktcurlSob{\ddom}{\rho}$.
\end{proof}
That is to say, proposition \ref{prop:CurlOfGradIsZero} informs us that the $\kt$-tangential curl of a $\kt$-tangential gradient is zero.

Another remark that deserves to be made is that given the construction of $W^{\kt}_{\rho,\mathrm{grad}}$, it is of course sufficient to only test orthogonality of $u$ against smooth $\kt$-gradients when checking if a field is divergence free.
\begin{cory} \label{cory:DivFreeSufficient}
	If
	\begin{align*}
		0 &= \integral{\ddom}{ u\cdot\overline{\ktgrad\phi} }{\rho}, \qquad\forall\phi\in\smooth{\ddom},
	\end{align*}
	then $u$ is $\kt$-divergence free with respect to $\rho$.
\end{cory}
\begin{proof}
	If $\bracs{v,g}\in W^{\kt}_{\rho,\mathrm{grad}}$ take an approximating sequence as in \eqref{eq:GradZeroSequenceDef}.
	Then clearly
	\begin{align*}
		\integral{\ddom}{ u\cdot\overline{g} }{\rho} 
		&= \lim_{n\rightarrow\infty}\integral{\ddom}{ u\cdot\overline{\ktgrad\phi_n} }{\rho}
		= \lim_{n\rightarrow\infty} 0 = 0.
	\end{align*}
\end{proof}
Corollary \ref{cory:DivFreeSufficient} does mean that definition \ref{def:ktDivergenceFree} can be weakened, however we chose to present the definition of ``divergence free" in this manner to maintain parallels to the usual intuition of a divergence free field being orthogonal to \emph{all} gradients.
