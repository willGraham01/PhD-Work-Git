\chapter{Vector Equations} \label{ch:VectorEqns}
Chapter \ref{ch:ScalarEqns} introduced the theory of Sobolev spaces $\gradSob{D}{\nu}$ with respect to arbitrary (Borel) measures $\nu$, and how we can make sense of the notion of ``derivative" and pose problems in these spaces.
Also investigated was how (under suitable regularity assumptions) the variational problems that can be posed are reduced to Quantum Graph problems, when the measure $\nu$ supports a graph embedded into the domain $D$. \newline

In this chapter we look to develop this theory to handling vector-valued systems of equations, which necessitates developing theory for the associated curl- and divergence-operations, as well as the associated Sobolev spaces.
We begin with the definition and construction of these spaces, during which we will demonstrate parallels with the previously seen concepts of ``tangential-gradients".
In fact, many of the arguments in this chapter will be inspired or grounded in the approaches taken in chapter \ref{ch:ScalarEqns}.
After this we will discuss slightly altered versions of these spaces, which will arise from considering the wave-propagation problems of interest to us.
We will provide a worked example in this context, and once again demonstrate how we can obtain a Quantum Graphs problem from a variational formulation when the measure $\nu$ supports a graph in the $\bracs{x_1,x_2}$-plane.

\section{Vector Sobolev Spaces} \label{sec:VectorSobSpaces}
In this section we present the construction of Sobolev spaces of vector-valued functions that possess curls (in some sense) with respect to an arbitrary (Borel) measure $\nu$.
In later sections we will adapt the construction of these spaces to suit our physical wave-guide and photonic-fibre systems; by taking a Fourier transform along the axis of the wave-guide and also incorporating the quasi-momentum that arises from taking a Gelfand transform in the cross-section.
The reader is invited to bear in mind the arguments employed in section \ref{sec:ScalarSobolevSpaces} throughout this section. \newline

We write $D\subset\reals^3$ for our 3D-domain, and let $\nu$ be an arbitrary (Borel) measure on $D$.
Let $W=W\bracs{D,\md\nu}$ be the closure of the set of pairs $\bracs{\phi, \curl{}\phi}$ in $\ltwo{D}{\nu}^3\times\ltwo{D}{\nu}^3$ for $\phi\in\smooth{D}$.
Given that this is essentially the same construction as in section \ref{sec:ScalarSobolevSpaces}, it is unsurprising to learn that some work must be done before the element $c$ in the pair $\bracs{u,c}\in W$ can be thought of as a ``curl".
Indeed we actually have the same problem as in the gradient case; if both $\bracs{u,c_1}, \bracs{0, c_2}\in W$ then $\bracs{u,c_1+c_2}\in W$, and so we define the set of $\nu$-curls of zero as
\begin{align*}
	\curlZero{D}{\nu} &:= \clbracs{ c\in\ltwo{D}{\nu}^3 \ \vert \ \bracs{0,c}\in W }, \\
	&= \clbracs{ c\in\ltwo{D}{\nu}^3 \ \vert \ \exists\phi\in\bracs{\smooth{D}}^3 \text{ s.t. } \phi_n\lconv{\ltwo{D}{\nu}^3}0, \curl{}\phi_n\lconv{\ltwo{D}{\nu}^3}c }
\end{align*}
Fortunately we have the same workaround (or fix) to address this issue as in the gradient case, namely that $\curlZero{D}{\nu}$ is a closed linear subspace of $\ltwo{D}{\nu}^3$ so we can write
\begin{align*}
	\ltwo{D}{\nu}^3 = \curlZero{D}{\nu}^\perp \oplus \curlZero{D}{\nu},
\end{align*}
thus every $u\in\ltwo{D}{\nu}^3$ has a unique tangential $\nu$-curl, $\curl{\nu} u$ such that every $\bracs{u,c}\in W$ can be written in the form $\bracs{u, \curl{\nu}u + \widetilde{c}}\in W$ for some $\widetilde{c}\in\curlZero{D}{\nu}$.
Thus we can define the Sobolev space of functions $u$ with $\nu$-curls by
\begin{align*}
	\curlSob{D}{\nu} := \clbracs{ \bracs{u,\curl{\nu}u}\in W },
\end{align*}
and although elements of this space are technically pairs, it is sufficient to specify only the first component $u$ to identify the pair.
We can also pose problems in this space using a variational formulation in an analogous way to gradients; we write
\begin{align*}
	\curl{\nu}\bracs{A\curl{\nu}u} + u &= f, \quad u\in\curlSob{D}{\nu},
\end{align*}
and interpret this as the variational problem of finding $u\in\curlSob{D}{\nu}$ such that
\begin{align*}
	\integral{D}{ A\bracs{\curl{\nu}u}\cdot\overline{\bracs{\curl{}\phi}} + u\overline{\phi}}{\nu} &= \integral{D}{ f\overline{\phi} }{\nu}, \quad \forall\phi\in\bracs{\smooth{D}}^3.
\end{align*}
Such problems actually serve as the motivation for the notion of the tangential curl that is provided in the same way as tangential gradients were motivated.
The elliptic matrix $A$ simply requires us to write $A\curl{\nu}u$ for the element in $\curlZero{D}{\nu}^\perp$, the details being analogous to those in section \ref{sec:ScalarSobolevSpaces} for gradients. \newline

We also interpret spectral problems in the variational setting, so 
\begin{align*}
	\curl{\nu}\bracs{\curl{\nu}u} &= \lambda u, \quad u\in\curlSob{D}{\nu},
\end{align*}
is interpreted as the problem of finding $\lambda\in\complex, u\in\curlSob{D}{\nu}$ such that
\begin{align*}
	\integral{D}{ \bracs{\curl{\nu}u}\cdot\overline{\bracs{\curl{}\phi}} }{\nu} &= \lambda \integral{D}{ u\overline{\phi} }{\nu}, \quad \forall\phi\in\bracs{\smooth{D}}^3.
\end{align*}
Taking $\phi = \grad\psi$ for some $\psi\in\smooth{D}$, then we have that
\begin{align*}
	0 &= \lambda \integral{D}{ u\overline{\grad\psi}}{\nu}, \quad \forall \psi\in\smooth{D}.
\end{align*}
This gives rise to the notion of $\nu$-divergence free functions, which we define as follows.
\begin{definition}
	A function $u\in\ltwo{D}{\nu}^3$ is $\nu$-divergence free if
	\begin{align*}
		\integral{D}{ u\cdot\overline{\grad_{\nu}f} }{\nu} &= 0, \quad \forall f\in\gradSob{D}{\nu}.
	\end{align*}	 
\end{definition}
Of course due to the density of $\smooth{D}$ in $\ltwo{D}{\nu}$ and the construction of $\gradSob{D}{\nu}$, it is sufficient to test the condition
\begin{align*}
	\integral{D}{ u\cdot\overline{\grad\psi} }{\nu} &= 0, \quad \forall \psi\in\smooth{D}
\end{align*}
to show that $u$ is $\nu$-divergence free (due to the applicability of the aforementioned limiting and density arguments).

\tstk{on the divergence-free condition and why we need it !!!}

\section{Illustrative Examples} \label{sec:CurlExamples}
\tstk{everything is a curl of zero on segment example, and (hopefully, if you fix it!) the plane-example for the interpretation.}

Let $I$ be a segment in $\reals^3$ with $x_2=x_3=0$ on $I$, and let $\nu$ be the singular measure on $\reals^3$ that supports 1D Lebesgue measure on $I$.
In this setup we demonstrate that $\curlZero{\reals^3}{\nu}$ actually coincides with the whole of $\ltwo{\reals^3}{\nu}$, so the only tangential $\nu$-curl is the zero function!
To this end, let $f\in\smooth{\reals^3}$, $v=\bracs{0,0,f}^\top\in\ltwo{\reals^3}{\nu}^3$ and consider the ``sequence" of functions $\phi^{(n)}=\phi=\bracs{-x_2 f, 0, 0}^\top$.
Then we have that
\begin{align*}
	\integral{\reals^3}{\abs{\phi}^2}{\nu} &= \integral{I}{x_2^2\abs{f}^2}{\nu} \\
	&= 0, \quad \text{as } x_2=0 \text{ on } I.
\end{align*}
Furthermore,
\begin{align*}
	\integral{\reals^3}{\abs{\curl{}\phi - v}^2}{\nu} &= \integral{I}{\abs{0-0}^2}{\nu} + \integral{I}{\abs{-x_2\partial_3 f - 0}^2}{\nu} + \integral{I}{\abs{f + x_2\partial_2 f - f}^2}{\nu} \\
	&= \integral{I}{x_2^2\abs{f}^2}{\nu} + \integral{I}{x_2^2\abs{\partial_2 f}^2}{\nu}
	= 0.
\end{align*}
Thus the (constant) sequence $\bracs{\phi^{(n)}}_{n\in\naturals}$ is such that
\begin{align*}
	\phi^{(n)} \lconv{\ltwo{\reals^3}{\nu}^3} 0, &\quad \curl{}\phi^{(n)} \lconv{\ltwo{\reals^3}{\nu}^3} v,
\end{align*}
and thus $v\in\curlZero{\reals^3}{\nu}$.
A similar argument then applies in the cases when;
\begin{itemize}
	\item $v=\bracs{0, f, 0}^\top$, by choosing the constant sequence $\phi = \bracs{x_3 f, 0, 0}^\top$.
	\item $v=\bracs{f, 0, 0}^\top$, by choosing the constant sequence $\phi = \bracs{0, -x_3 f, 0}^\top$.
\end{itemize}
As such we conclude that if $f\in\smooth{\reals^3}$, then
\begin{align*}
	\begin{pmatrix}	f \\ 0 \\ 0	\end{pmatrix},
	\begin{pmatrix}	0 \\ f \\ 0	\end{pmatrix},
	\begin{pmatrix}	0 \\ 0 \\ f	\end{pmatrix}
	\in \curlZero{\reals^3}{\nu}.
\end{align*}
But then applying density arguments for $\smooth{\reals^3}$ in $\ltwo{\reals^3}{\nu}$ and the fact that $\curlZero{\reals^3}{\nu}$ is a closed linear subspace of $\ltwo{\reals^3}{\nu}^3$ by definition, we must conclude that
\begin{align*}
	\curlZero{\reals^3}{\nu} &= \mathrm{span}\clbracs{	
	\begin{pmatrix}	f \\ 0 \\ 0	\end{pmatrix},
	\begin{pmatrix}	0 \\ f \\ 0	\end{pmatrix},
	\begin{pmatrix}	0 \\ 0 \\ f	\end{pmatrix}
	\ \vert \ f\in\ltwo{\reals^3}{\nu}
	} \\
	&= \ltwo{\reals^3}{\nu}.
\end{align*}

\tstk{what about plane-measure case? Can't get that to work still - can in-plane directions are arbitrary l2 functions, but can't prove that orthogonal part to plane is zero.}

\section{$\wavenumber$-curls and Quasi-Momentum} \label{sec:kCurlsAndQM}
As discussed in chapter \ref{ch:Intro}, the physical systems of interest to us are those involving wave-guidance .
In particular we will typically be seeking solutions in the form of a travelling wave down the axis of the wave-guide, and solving for the transverse components of the wave in the cross-section of the guide.
In such problems it is standard practice to take a Fourier transform in the direction along the wave-guide axis; in our case this coincides with the $x_3$ co-ordinate direction.
As such we introduce the Fourier variable $\wavenumber$ and accordingly adjust the $\grad$ operator to account for this transform, denoting by $\kgrad$ the operator
\begin{align*}
	\kgrad\phi := \begin{pmatrix} \partial_1\phi \\ \partial_2\phi \\ i\wavenumber\phi\end{pmatrix}
\end{align*}
for all smooth functions $\phi$ of the cross-section variables $x_1,x_2$ which map into $\complex^3$.
Furthermore; under the assumptions laid out in section \ref{sec:PhysicalSystem} \tstk{this needs to exist at some point!} we will also be taking a Gelfand transform in our periodic, yet infinite, cross-section plane to obtain a family of problems on the period cell $\ddom$ parametrised by the quasi-momentum $\qm$.
Thus in the systems that we are considering it will be necessary for us to consider the operator $\ktgrad$ which element-wise is defined as
\begin{align*}
	\ktgrad := \kgrad + i\begin{pmatrix} \qm_1 \\ \qm_2 \\ 0 \end{pmatrix}.
\end{align*}
Since these operators are nothing more than the result of unitary transforms on the function spaces considered in section \ref{sec:VectorSobSpaces}, the theory is preserved, however we must still perform some explicit computations to characterise the objects that we will be working with.
Also note that the operator $\ktgrad$ replaces the operator $\grad$, and so we are in effect seeking the $\bracs{\wavenumber,\qm}$-tangential curl, gradient, and divergence-free conditions. \newline

Throughout this section we assume our usual set-up; we have some period cell $\ddom$ in which is an embedded graph $\graph=\bracs{V,E}$, and we denote by $\ddmes$ the singular measure supported on the edges of $\graph$.

\subsection{$\bracs{\wavenumber,\qm}$-gradients} \label{sec:ktGradients}
In this subsection we will work towards characterising $\bracs{\wavenumber,\qm}$-tangential gradients.
This will first involve us characterising the set of gradients of zero, $\kgradZero{\ddom}{\ddmes}$, however there will be several parallels with the methods and results of section \ref{sec:ScalarExample}.

\subsection{The Divergence-Free Condition} \label{sec:ktDivFree}
Having established characterisations for both $\kgradZero{\ddom}{\ddmes}$ and the tangential gradients, we can now examine what it means for a function $u\in\ktcurlSob{\ddom}{\ddmes}$ to be divergence free.
As usual, it is sufficient for us to consider a single edge $I$ which we take to be parallel to the $x_2$-axis and then make use of rotations and the edge-wise natural of $\ddmes$ to extend the results to the whole of $\graph$. \newline

\subsection{$\bracs{\wavenumber,\qm}$-curls} \label{sec:ktCurls}
Our primary focus here is to characterise tangential curls; and our analysis follows in much of the same vein as in section \ref{sec:ScalarExample}.
First we seek an edge-wise understanding for $\bracs{\wavenumber,\qm}$-curls of zero and tangential curls, then we derive an extension result (c.f. \tstk{extension lemma result here}) for curls so that our edge-wise characterisation also provides us with a graph-wide form for the curl.
We will need the following result on rotations during this section:
\tstk{rotating curls goes here}

\section{Reduction to Quantum Graphs} \label{sec:CurlReductionToQG}

\section{Chapter Summary} \label{sec:CurlSummary}

%\section{Curls of Zero - a need for care}

%This result is quite perplexing at first, however a similar example can help us shed some light onto the matter.
%We now consider a plate $P = \clbracs{0}\times I_2\times I_3$ in $\dddom\subset\reals^3$, and let $\dddmes$ be the measure that supports 2D Lebesgue measure on the plate $P$.
%Looking to characterise $\curlZero{\dddom}{\dddmes}$ we quickly establish that
%\begin{align*}
%	\begin{pmatrix} 0 \\ u \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 0 \\ u \end{pmatrix}
%	\in \curlZero{\dddom}{\dddmes} \quad \forall u\in\smooth{\dddom},
%\end{align*}
%by considering the functions $\phi=\bracs{0, 0, -x_1 u}$ and $\phi=\bracs{0, x_1 u, 0}$ and using the fact that $x_1=0$ on $P$.
%After density arguments, this tells us that
%\begin{align*}
%	 \mathrm{span}\clbracs{
%	 \begin{pmatrix} 0 \\ u \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 0 \\ u \end{pmatrix}
%	 \ \vert \ u\in\ltwo{\dddom}{\dddmes}
%	 }\subset \curlZero{\dddom}{\dddmes}
%\end{align*}
%We now verify that the only function of the form $v=\bracs{u,0,0}^\top$ that is an element of $\curlZero{\dddom}{\dddmes}$ is the zero function. \tstk{fill in these steps too}.
%
%These two examples can be used to propose a notion of curl with respect to arbitrary measure.
%One interprets the familiar classical curl of a function $u$ (that is, curl with respect to Lebesgue measure in 3D) as the axis of rotation of an infinitesimally small sphere placed within the vector field $u$.
%The question we should be asking is ``how much of this rotation does the measure we are using actually see"?
%Consider the plate example first, and the diagram drawn in figure \ref{fig:CurlInterpFigure}.
%\begin{figure}[ht]
%	\centering
%	\includegraphics[scale=1.0]{Diagram_CurlZeroPlane.pdf}
%	\caption{\label{fig:CurlInterpFigure} Diagram to illustrate the interpretation of curls of $\dddmes$. See the main body of text for the full explanation.}
%\end{figure}
%Consider the path traced out by a point on the surface of a sphere (of small radius) placed inside the vector field $u$, and the projection of this area onto the plate $P$. 
%When the axis of rotation is perpendicular to $P$, this projection is a 2D subset of $P$ and has non-zero $\dddmes$-measure. 
%If the axis is parallel to $P$, the projection is a 1D subset of $P$ and so has zero $\dddmes$-measure.
%As such for a general axis of rotation $v$, the measure $\dddmes$ is only able to ``see" the rotation induced by the component of $v$ perpendicular to the plate $P$.
%Now consider the same picture as in figure \ref{fig:CurlInterpFigure} but replacing the plate $P$ with a line segment $\widetilde{I}$.
%In this case the projection of the area onto $\widetilde{I}$ is a finite set of at most two points, so will have zero $\lambda_I$-measure regardless of the axis of rotation $v$.
%Hence our earlier conclusion that $\curlZero{\dddom}{\lambda_I}=\ltwo{\dddom}{\lambda_I}^3$, the measure $\lambda_I$ simply can't ``see" any rotation ``in $\widetilde{I}$".
%
%\section{A Waveguide Problem}
%The $k$-curls stuff and getting to the edge equations.
%\tstk{about taking the Fourier transform, so now we're in 2D with a param $k$, and then refer back to section \ref{sec:ScalarExample} for the notation for the graph etc. Commented out stuff below might be useful for recycling this code.}
%%As such we let $\dddom=\ddom\times I\subset\reals^2\times\reals$, where $\ddom$ will be the domain for our cross-sectional structure.
%%We consider the plate $P=\mathset{0}\times I_2 \times I\subset\dddom$ and the singular measure $\dddmes$ that supports 2D Lebesgue measure on $P$.
%%By assumptions on the waveguide geometry we can write $\dddmes=\ddmes \otimes \lambda_1$; and we would be looking to study the problem
%%\begin{align} \label{eq:CurlProblemPreFT}
%%	\curl{\dddmes}\bracs{\curl{\dddmes}u} &= \omega^2 u, \quad u\in\curlSob{\dddom}{\dddmes}
%%\end{align}
%%understood in the weak sense on $\dddom$.
%%We take the Fourier transform in the $x_3$ direction, providing us with a family of problems in 2D obtains by transforming \eqref{eq:CurlProblemPreFT} and integrating out the $x_3$ dependence.
%%The Fourier variable is denoted by $k\in\reals$, and we obtain for each $k$ the problem
%%\begin{align} \label{eq:CurlProblem}
%%	\curl{k}\bracs{\curl{k}u} &= \omega^2 u, \quad u\in\curlkSob{\ddom}{\ddmes}
%%\end{align}
%%where the operator $\curl{k}=\bracs{\partial_1,\partial_2,ik}^{\top}$ formally, and is understood with respect to the measure $\ddmes$.
%%The space $\curlkSob{\ddom}{\ddmes}$ is the space we end up in after taking the Fourier transform, for a given $k$ it consists of $\ltwo{\ddom}{\ddmes}$ functions and their $k$-curls.
%%As such we are now dealing with a 2D-problem with a measure $\ddmes$ that supports 1D Lebesgue measure down the segment $I_2\subset\ddom$.
%%We seek to characterise the $k$-curls of zero and then derive the edge equations for \eqref{eq:CurlProblem}.
%
%\subsection{The set $\kcurlZero{\ddom}{\ddmes}$} 
%\tstk{need to do the full analysis, RN this is just for a single segment and then stops!}
%We denote by $\kcurlZero{\ddom}{\ddmes}$ the set of all $k$-curls of the function $u\in\ltwo{\ddom}{\ddmes}$.
%As when we were considering scalar-valued functions (see section \ref{sec:ScalarExample}), our interest here is in characterising the set of $k$-curls of zero. \newline
%
%\subsubsection{Single Segments in the Plane}
%We begin our analysis by considering the case when $\ddmes$ supports 1D Lebesgue measure along some segment $\clbracs{0}\times I_2\subset\ddom$, so $\ddmes=\lambda_{I_2}$.
%With the goal of characterising $\kcurlZero{\ddom}{\lambda_{I_2}}$, consider some scalar $u\in\smooth{\ddom}$ and let $v = \bracs{0,u,0}^{\top}$ (again we only consider smooth $u$ because we can apply density arguments to extend the result to $\ltwo{\ddom}{\lambda_{I_2}}$ functions).
%Now we observe that $v\in\kcurlZero{\ddom}{\lambda_{I_2}}$ because the (smooth) constant sequence $\phi^{(n)} = \phi = \bracs{0,0,-x_1 u}^{\top}$ satisfies;
%\begin{align*}
%	\integral{\ddom}{\abs{\phi}^2}{\lambda_{I_2}} &= \integral{I_2}{x_1^2\abs{u}^2}{\lambda_{I_2}} \\
%	&= 0 \quad\text{as } x_1 = 0 \text{ on } I_2,
%\end{align*}
%and additionally
%\begin{align*}
%	\integral{\ddom}{\abs{\kcurl{\lambda_{I_2}}\phi - v}^2}{\lambda_{I_2}} &= \integral{\ddom}{\abs{\partial_2\phi_3 - ik\phi_2}^2}{\lambda_{I_2}} \\
%	&+ \integral{\ddom}{\abs{ik\phi_1 - \partial_1\phi_3 - u}^2}{\lambda_{I_2}} + \integral{\ddom}{\abs{\partial_1\phi_2 - \partial_2\phi_1}^2}{\lambda_{I_2}} \\
%	&= \integral{I_2}{x_1^2\abs{\partial_2 u}^2 + x_1^2\abs{\partial_1 u}^2}{\lambda_{I_2}} \\
%	&= 0.
%\end{align*}
%Hence we have that
%\begin{align} \label{eq:Curl0SeqConv}
%	\phi^{(n)} \lconv{\ltwo{\ddom}{\lambda_{I_2}}^3},
%	&\quad \kcurl{\lambda_{I_2}}\phi^{(n)} \lconv{\ltwo{\ddom}{\lambda_{I_2}}^3} v.
%\end{align}
%so $v\in\kcurlZero{\ddom}{\lambda_{I_2}}$.
%By a similar argument we can also deduce that $w=\bracs{0,0,u}\in\kcurlZero{\ddom}{\lambda_{I_2}}$, by taking the constant sequence $\varphi^{(n)}=\bracs{0,x_1 u,0}^{\top}$.
%Hence we conclude that (after density arguments)
%\begin{align*}
%	\mathrm{span}\clbracs{\begin{pmatrix} 0 \\ u \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 0 \\ u \end{pmatrix} \ \vert \ u\in\ltwo{\ddom}{\ddmes}} \subset \kcurlZero{\ddom}{\lambda_{I_2}}.
%\end{align*}
%We now look to show that vectors $v$ of the form $v=\bracs{u,0,0}, u\in\ltwo{\ddom}{\lambda_{I_2}}$ are not elements of $\kcurlZero{\ddom}{\lambda_{I_2}}$.
%To this end, let $v$ have this form for a smooth $u$ (as we can again apply density arguments at the end) and suppose that $v\in\kcurlZero{\ddom}{\lambda_{I_2}}$.
%Then there exists some sequence of smooth functions $\phi^{(n)}$ such that \eqref{eq:Curl0SeqConv} holds.
%Algebraic manipulation of these convergences written as integrals yields the following convergences in $\ltwo{\ddom}{\lambda_{I_2}}$:
%\begin{align*}
%	\phi^{(n)}_j &\rightarrow 0 \quad \forall j\in\clbracs{1,2,3}, \\
%	\partial_2\phi^{(n)}_3 - ik\phi^{(n)}_2 &\rightarrow u, \\
%	ik\phi^{(n)}_1 - \partial_1\phi^{(n)}_3 &\rightarrow 0, \\
%	\partial_1\phi^{(n)}_2 - \partial_2\phi^{(n)}_1 &\rightarrow 0.
%\end{align*}
%In particular taking $j=1,2$ in the first convergence implies by the algebra of limits that
%\begin{align*}
%	\partial_2\phi^{(n)}_3 &\rightarrow u, \text{ and } \partial_1\phi^{(n)}_3\rightarrow 0.
%\end{align*}
%Combined with the $j=3$ case, we find that
%\begin{align*}
%	\phi^{(n)}_3 \lconv{\ltwo{\ddom}{\lambda_{I_2}}} 0,
%	&\grad\phi^{(n)}_3 \lconv{\ltwo{\ddom}{\lambda_{I_2}}^2} \begin{pmatrix} 0 \\ u \end{pmatrix}.
%\end{align*}
%Namely that $\bracs{0, u}^{\top}\in\gradZero{\ddom}{\lambda_{I_2}}$.
%Thus by the characterisation of $\gradZero{\ddom}{\lambda_{I_2}}$, we conclude that $u=0$.
%Hence we have the desired result,
%\begin{align*}
%	\kcurlZero{\ddom}{\lambda_{I_2}} &= \mathrm{span}\clbracs{\begin{pmatrix} 0 \\ u \\ 0 \end{pmatrix}, \begin{pmatrix} 0 \\ 0 \\ u \end{pmatrix} \ \vert \ u\in\ltwo{\ddom}{\lambda_{I_2}}} \labelthis\label{eq:OneParallelSegmentCurl0Form}\\
%	&= \clbracs{g\in\ltwo{\ddom}{\lambda_{I_2}}^3 \ \vert \ g\cdot n_{I_2} = 0} 
%\end{align*}
%where $n_{I_2}$ denotes the vector in $\reals^3$ that is normal to the plane $\clbracs{0}\times I_2\times[0, \infty)$. \tstk{remark about how this is one of the F.T'ed planes in our waveguide.}
%
%\tstk{now what happens if we rotate? I think we can transform as normal, effectively extending the 2-by-2 rotation matrix $R$ to a 3-by-3 by adding a one at position 3-3 and zeros elsewhere... but need to be careful as we're not rotating curl, but are rotating $k$-curl!}
%We now consider the case when $\ddmes$ supports a segment $I\subset\ddom$ which is not necessarily parallel to the $x_2$-axis, so $\ddmes=\lambda_I$.
%Let $I$ have the orthogonal co-ordinate system $y=\bracs{y_1,y_2}$ with $y_2$ parallel to $I$, and let $R$ be the orthogonal matrix that transforms between $x=\bracs{x_1,x_2}$ co-ordinates and $y$ co-ordinates by $x=Ry$.
%Suppose that $v\in\kcurlZero{\ddom}{\lambda_I}$ - then as usual we can find a sequence of smooth functions $\phi^{(n)}\in\smooth{\ddom}^3$ such that
%\begin{align*}
%	\phi^{(n)} \lconv{\ltwo{\ddom}{\lambda_I}^3} 0, &\quad \kcurl{y}\phi^{(n)} \lconv{\ltwo{\ddom}{\lambda_I}^3} v \toInfty{n}.
%\end{align*}
%Here we use the subscript $y$ to denote the co-ordinate system on which $grad^{(k)}$ is taken with respect to.
%Define the matrix $\hat{R}$ by
%\begin{align*}
%	\hat{R} &= 
%	\begin{pmatrix}
%		R & 0 \\
%		0 & 1
%	\end{pmatrix}
%\end{align*}
%so $\hat{R}$ is a $3\times3$ orthogonal matrix.
%Define $\psi^{(n)}\bracs{x} = \phi^{(n)}\bracs{R^\top x}$, and let $I_2 = R^\top I$ which is parallel to the $x_2$-axis by construction.
%Then by change of variables
%\begin{align*}
%	\integral{I_2}{\abs{\psi^{(n)}}^2}{\lambda_{I_2}}
%	&= \integral{I}{\abs{\phi^{(n)}}^2}{\lambda_I} \\
%	&\rightarrow0 \toInfty{n},
%\end{align*}
%and
%\begin{align*}
%	\integral{I_2}{\abs{\kcurl{x}\psi^{(n)}\bracs{x}-\hat{R}^\top v\bracs{R^\top x}}^2}{\lambda_{I_2}}
%	&= \integral{I_2}{\abs{\hat{R}\kcurl{x}\psi^{(n)}\bracs{x}- v\bracs{R^\top x}}^2}{\lambda_{I_2}} \\
%	&= \integral{I_2}{\abs{\kcurl{y}\phi^{(n)}\bracs{R^\top x}- v\bracs{R^\top x}}^2}{\lambda_{I_2}} \\
%	&= \integral{I}{\abs{\kcurl{y}\phi^{(n)}\bracs{y}- v\bracs{y}}^2}{\lambda_I} \\
%	&\rightarrow0 \toInfty{n}.
%\end{align*}
%Thus the function $w\bracs{x} = \hat{R}^\top v\bracs{R^\top x}$ belongs to $\kcurlZero{R\ddom}{\lambda_{I_2}}$, and has the form as in \eqref{eq:OneParallelSegmentCurl0Form}.
%So we can write $w=\bracs{0, w_2, w_3}^\top$ for some $w_2,w_3\in\ltwo{R\ddom}{\lambda_{I_2}}$, and thus we have that
%\begin{align*}
%	v\bracs{y} = \hat{R}\begin{pmatrix} 0 \\ v_2 \\ v_3	\end{pmatrix}
%\end{align*}
%for functions $v_2,v_3\in\ltwo{\ddom}{\lambda_I}$ (which are related to $w_2, w_3$ by the change of variables $R$).
%Hence we conclude that
%\begin{align} \label{eq:OneArbitrarySegmentCurl0Form}
%	\kcurlZero{\ddom}{\lambda_I} &= \clbracs{g\in\ltwo{\ddom}{\lambda_I}^3 \ \vert \ g\cdot n_I = 0},
%\end{align}
%where $n_I$ denotes the vector in $\reals^3$ that is normal to the plane $\clbracs{0}\times I\times[0, \infty)$; similar to before.
%We now utilise these results to characterise the $k$-curl on a graph-like structure by it's structure on each of the edges, akin to the scalar-gradient case.
%
%\subsubsection{$k$-Curls on Finite Graphs}
%Suppose now that $\ddmes$ supports an embedded graph $\graph$ in $\ddom$.
%We look to prove that
%\begin{align} \label{eq:kCurlZeroSetEquivalence}
%	\kcurlZero{\ddom}{\ddmes} &= \clbracs{g\in\ltwo{\ddom}{\ddmes}^3 \ \vert \ g\vert_{I_{ij}}\cdot n_{ij} = 0 \ \forall I_{ij}\in E},
%\end{align}
%where $n_{ij}$ denotes the unit vector that is normal to the plane induced by the segment $I_{ij}$ and the $x_3$-axis.
%Denote the set on the right hand side of \eqref{eq:kCurlZeroSetEquivalence} by $B$.
%As when we were considering gradients (see section \ref{sec:ScalarExample}) the inclusion $\kcurlZero{\ddom}{\ddmes}\subset B$ follows quickly.
%\begin{prop} \label{prop:Curl0IncB}
%	For $B = \clbracs{g\in\ltwo{\ddom}{\ddmes}^3 \ \vert \ g\vert_{I_{ij}}\cdot n_{ij} = 0 \ \forall I_{ij}\in E}$, we have that
%	\begin{align*}
%		\kcurlZero{\ddom}{\ddmes}\subset B.
%	\end{align*}
%\end{prop}
%\begin{proof}
%	Let $g\in\kcurlZero{\ddom}{\ddmes}$.
%	Then there exist smooth functions $\phi^{(n)}$ such that
%	\begin{align*}
%		\phi^{(n)} \lconv{\ltwo{\ddom}{\ddmes}^3} 0, 
%		&\quad \kcurl{}\phi^{(n)} \lconv{\ltwo{\ddom}{\ddmes}^3} g \toInfty{n}.
%	\end{align*}
%	Thus we find that
%	\begin{align*}
%		\sum_{I_{ij}\in E}\integral{I_{ij}}{\abs{\phi^{(n)}}^2}{\lambda_{ij}} &= \integral{\ddom}{\abs{\phi^{(n)}}^2}{\ddmes} \rightarrow 0 \toInfty{n}, \\
%		\Rightarrow \integral{I_{ij}}{\abs{\phi^{(n)}}^2}{\lambda_{ij}} &\rightarrow0 \toInfty{n} \ \forall I_{ij}\in E,
%	\end{align*}
%	and that
%	\begin{align*}
%		\sum_{I_{ij}\in E}\integral{I_{ij}}{\abs{\kcurl{}\phi^{(n)}-g\vert_{I_{ij}}}^2}{\lambda_{ij}} &= \integral{\ddom}{\abs{\kcurl{}\phi^{(n)}-g}^2}{\ddmes} \rightarrow 0 \toInfty{n}, \\
%		\Rightarrow \integral{I_{ij}}{\abs{\kcurl{}\phi^{(n)}-g\vert_{I_{ij}}}^2}{\lambda_{ij}} &\rightarrow0 \toInfty{n} \ \forall I_{ij}\in E.
%	\end{align*}
%	Hence 
%	\begin{align*}
%			g\in\kcurlZero{\ddom}{\lambda_{ij}} \ \forall I_{ij}\in E
%	\end{align*}
%	and so by \eqref{eq:OneArbitrarySegmentCurl0Form} we conclude that $g\vert_{I_{ij}}\cdot n_{ij} = 0$ for every edge $I_{ij}$.
%	That is, $g\in B$.
%\end{proof}
%
%The reverse inclusion requires some further preliminary results before it can be proven; but the method of our argument follows much the same vein as the one used when considering gradients, in section \ref{sec:ScalarExample}.
%\begin{lemma}[Extension of $k$-Curls on Segments to Whole Graph] \label{lem:SegkCurlExtend}
%	Let $I_{ij}^n=\clbracs{ x\in I_{ij} \ \vert \ \mathrm{dist}\bracs{x,I_{ij}}\geq\recip{n} }$.
%	Suppose $g\in\ltwo{\ddom}{\ddmes}^3$ with $g=0$ on $\ddom\setminus I_{ij}^n$ and $g\cdot n_{ij}=0$ on $I_{ij}^n$.
%	Then $g\in\kcurlZero{\ddom}{\ddmes}$.
%\end{lemma}
%\begin{proof}
%	As $g\cdot n_{ij}=0$ on $I_{ij}^n$ and $g=0$ on $\ddom\setminus I_{ij}^n$ we have that $g\vert_{I_{ij}}\cdot n_{ij}=0$ so $g\in\kcurlZero{\ddom}{\lambda_{ij}}$.
%	Thus there exist smooth functions $\phi^{(l)}$ with the usual convergence properties.
%	Let $\chi_{ij}^n\in\smooth{\ddom}$ be the smooth function such that
%	\begin{align*}
%		\chi_{ij}^n\bracs{x} &= \sqbracs{0,1}, \\
%		\chi_{ij}^n\bracs{x} &= 1 \text{ when } \mathrm{dist}\bracs{x,I_{ij}^n}\leq \recip{3n}, \\
%		\chi_{ij}^n\bracs{x} &= 0 \text{ when } \mathrm{dist}\bracs{x,I_{ij}^n}\geq\frac{2}{3n}.
%	\end{align*}
%	Then consider the sequence of smooth functions $\psi^{(l)}=\chi_{ij}^n\phi^{(l)}$.
%	Clearly
%	\begin{align*}
%		\integral{\ddom}{\abs{\psi^{(l)}}^2}{\ddmes} \leq \integral{\ddom}{\abs{\phi^{(l)}}^2}{\lambda_{ij}} \rightarrow0 \toInfty{l}.
%	\end{align*}
%	Next we note that
%	\begin{align*}
%		\kcurl{}\bracs{\chi_{ij}^n\phi^{(l)}} &= \chi_{ij}^n\kcurl{}\phi^{(l)} + \bracs{\grad^{(0)}\chi_{ij}^n}\wedge\phi^{(l)},
%	\end{align*}
%	where $\grad^{(0)}=\bracs{\partial_1, \partial_2, 0}^\top$ acts as the ``$k=0$" gradient operator.
%	Then we can see that
%	\begin{align*}
%		\integral{\ddom}{\abs{\kcurl{\ddmes}\psi^{(l)} - g}^2}{\ddmes}
%		&= \integral{\ddom}{\abs{\kcurl{\ddmes}\bracs{\chi_{ij}^n\phi^{(l)}} - g}^2}{\lambda_{ij}} \\
%		&= \integral{\ddom}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} + \bracs{\grad^{(0)}\chi_{ij}^n}\wedge\phi^{(l)} - g}^2}{\lambda_{ij}} \\
%		&\leq 2\integral{\ddom}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} + 2\integral{\ddom}{\abs{\bracs{\grad^{(0)}\chi_{ij}^n}\wedge\phi^{(l)}}^2}{\lambda_{ij}} \\
%		&\leq 2\integral{\ddom}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} + 2\sup_{I_{ij}}\bracs{\grad^{(0)}\chi_{ij}^n}\underbrace{\integral{\ddom}{\abs{\phi^{(l)}}^2}{\lambda_{ij}}}_{\rightarrow0 \toInfty{l}} \\
%	\end{align*}
%	Hence we simply need to examine
%	\begin{align*}
%		\integral{\ddom}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}}
%		&= \underbrace{\integral{I_{ij}\setminus I_{ij}^n}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}}}_{g=0 \text{ on } I_{ij}\setminus I_{ij}^n} \\
%		&+ \underbrace{\integral{I_{ij}^n}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}}}_{\chi_{ij}^n=1 \text{ on } I_{ij}^n} \\
%		&= \underbrace{\integral{I_{ij}\setminus I_{ij}^n}{\abs{\chi_{ij}^n\kcurl{\ddmes}\phi^{(l)}}^2}{\lambda_{ij}}}_{\chi_{ij}^n\leq 1 \text{ on } I_{ij}\setminus I_{ij}^n} 
%		+ \integral{I_{ij}^n}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} \\
%		&\leq \underbrace{\integral{I_{ij}\setminus I_{ij}^n}{\abs{\kcurl{\ddmes}\phi^{(l)}}^2}{\lambda_{ij}}}_{g=0 \text{ on } I_{ij}\setminus I_{ij}^n} 
%		+ \integral{I_{ij}^n}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} \\
%		&= \integral{I_{ij}\setminus I_{ij}^n}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} 
%		+ \integral{I_{ij}^n}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} \\
%		&= \integral{I_{ij}}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}}
%		= \integral{\ddom}{\abs{\kcurl{\ddmes}\phi^{(l)} - g}^2}{\lambda_{ij}} \\
%		&\rightarrow0 \toInfty{l}.
%	\end{align*}
%	Thus we conclude that
%	\begin{align*}
%		\psi^{(l)} \lconv{\ltwo{\ddom}{\ddmes}^3} 0, &\quad \kcurl{\ddmes}\psi^{(l)} \lconv{\ltwo{\ddom}{\ddmes}^3} g,
%	\end{align*}
%	so $g\in\kcurlZero{\ddom}{\ddmes}$.
%\end{proof}
%
%We next recall the function $\eta$ defined in section \ref{sec:ScalarExample}; $\eta\in\smooth{\ddom}$ has the properties
%\begin{align*}
%	\eta\bracs{x} &\in [0,1], \\
%	\eta = 0 &\text{ whenever } \abs{x}\leq 1, \\
%	\eta = 1 &\text{ whenever } \abs{x}\geq 2.
%\end{align*}
%Then for each $v_i\in V$ and $n\in\naturals$, we define
%\begin{align*}
%	\eta_i\bracs{x} = \eta\bracs{x-v_i}, &\quad \eta_i^n\bracs{x} = \eta_i\bracs{nx}
%\end{align*}
%which are clearly both smooth functions by composition.
%Recall lemma \ref{lem:etaConv} which proves convergence of $\eta_i^n$ to the constant function $1$ in $\ltwo{\ddom}{\ddmes}$.
%We are now ready to prove that $B\subset\kcurlZero{\ddom}{\ddmes}$, the proof of which is essentially identical to that of proposition \ref{prop:BIncGrad0}.
%\begin{prop} \label{prop:BInckCurl0}
%	For $B = \clbracs{g\in\ltwo{\ddom}{\ddmes}^3 \ \vert \ g\vert_{I_{ij}}\cdot n_{ij} = 0 \ \forall I_{ij}\in E}$, we have that
%	\begin{align*}
%		B \subset \kcurlZero{\ddom}{\ddmes}.
%	\end{align*}
%\end{prop}
%\begin{proof}
%	Take $g\in B$, and define a family of functions $g_{n}$ by
%	\begin{align*}
%		g_{n}\bracs{x} &= \recip{2}\sum_{i\in V}\sum_{i\sim j}\eta_{i}^{n}\bracs{x}\eta_{j}^{n}\bracs{x}g\vert_{I_{ij}}\bracs{x}
%	\end{align*}
%	where the notation $i\sim j$ means that there is an edge $(i,j)\in E$, and the sum is taken over such edges.
%	Recall that $\graph$ was assumed finite, so there are no convergence issues with the double sum.
%	Then for each $i,j$ with $i\sim j$, the function $\eta_{i}^{n}\eta_{j}^{n}g\vert_{I_{ij}}$ satisfies the hypothesis of \ref{lem:SegkCurlExtend}, so $\eta_{i}^{n}\eta_{j}^{n}g\vert_{I_{ij}}\in\kcurlZero{\ddom}{\ddmes}$.
%	Furthermore, as $\kcurlZero{\ddom}{\ddmes}$ is a linear subspace of $\ltwo{\ddom}{\ddmes}^{3}$, $g_{n}\in\kcurlZero{\ddom}{\ddmes}$ too, for all $n$.
%	By closure of $\kcurlZero{\ddom}{\ddmes}$; $g_{n}$ converges in $\kcurlZero{\ddom}{\ddmes}$ provided it converges at all, so it remains to show that $g_{n}\lconv{\ltwo{\ddom}{\ddmes}^3} g \toInfty{n}$.
%	However with the result of \ref{lem:etaConv}, we have that $\eta_{i}^{n}\eta_{j}^{n}g\vert_{I_{ij}}\lconv{\ltwo{\ddom}{\ddmes}^3} g\vert_{I_{ij}}$ and hence
%	\begin{align*}
%		g_{n} \lconv{\ltwo{\ddom}{\ddmes}^3} &\recip{2}\sum_{i\in V}\sum_{j\sim i}g\vert_{I_{ij}} = g \toInfty{n},
%	\end{align*}
%	so $g\in\kcurlZero{\ddom}{\ddmes}$.
%\end{proof}
%
%\subsection{Tangential $k$-Curl} \label{sec:TangKCurl}
%Now that we have a characterisation of $\kcurlZero{\ddom}{\ddmes}$ we can study those $k$-curls which are orthogonal to this set.
%So we take some $u\in\kSob{\ddom}{\ddmes}$ and write $\kcurl{\ddmes}u=\bracs{v_1,v_2,v_3}^{\top}$, and study the implications of the condition
%\begin{align*}
%	\integral{\ddom}{\bracs{\kcurl{\ddmes}u}\cdot\phi}{\ddmes} = 0 \quad\forall\phi\in\kcurlZero{\ddom}{\ddmes}
%\end{align*}
%on the $v_j$.
%By the characterisation of $\kcurlZero{\ddom}{\ddmes}$ we know that $\phi=\bracs{0,\phi_2, \phi_3}$ for some $\phi_2,\phi_3\in\ltwo{\ddom}{\ddmes}$, which leaves us with the requirement that
%\begin{align*}
%	\integral{\ddom}{v_2\phi_2 + v_3\phi_3}{\ddmes} = 0 \quad\forall\phi_2,\phi_3\in\ltwo{\ddom}{\ddmes}.
%\end{align*}
%Taking $\phi_2,\phi_3$ to be zero in separate cases implies that $v_2=v_3=0$, leaving $v_1$ as the only non-zero component of the $k$-curl.
%We claim that this component is related to a distributional derivative of a related function along the segment $I_2$. 
%Before we demonstrate this, we first set out some notation (akin to that used in section \ref{sec:ScalarExample}).
%Define $r:[0,\abs{I_2}]\rightarrow I_2$ as the map that parametrises $I_2=[v_0, v_1]$ by $$r(t) = v_0 + te_I$$ where $e_I$ is the unit vector directed from $v_0$ to $v_1$ (along $I_2$).
%We use an overhead tilde to denote composition with the function $r$, and note that $r^{\prime}(t) = e_I$ and $e_I=\bracs{0,1}^{\top}$ as $I_2$ is parallel to the $x_2$-axis. 
%Finally recall (an analogue of) \eqref{eq:PartialToTDiff}, for a differentiable scalar-valued function $\varphi$ we have that
%\begin{align} \label{eq:PartialToTDiff-Vector}
%	\partial_t\widetilde{\varphi}(t) &= \grad\varphi\bracs{r_{ij}(t)}\cdot r'_{ij}(t) = \partial_2\varphi\bracs{r_{ij}(t)} \\
%	&= \widetilde{\partial_2\varphi}(t).
%\end{align}
%
%By our earlier deduction we know that a tangential $k$-curl has the form $\kcurl{\ddmes}u=\bracs{v_1,0,0}^{\top}$.
%By definition we can therefore find a sequence of smooth functions $\phi^{(n)}$ such that 
%\begin{align*}
%	\phi^{(n)} \lconv{\ltwo{\ddom}{\ddmes}^3} u,
%	&\quad \kcurl{}\phi^{(n)} \lconv{\ltwo{\ddom}{\ddmes}^3} \begin{pmatrix} v_1 \\ 0 \\ 0 \end{pmatrix}.
%\end{align*}
%Writing these convergences in terms of integrals converging in $\reals$ we obtain\footnote{We actually obtain more information about the various components of $\phi^{(n)}$ and their limits, but we do not require this knowledge for the argument.} the following:
%\begin{align*}
%	\integral{\ddom}{\abs{\phi_j^{(n)}-u_j}^2}{\ddmes} &\rightarrow 0 \quad\text{as} \ n\rightarrow\infty, \ j=2,3\\
%	\integral{\ddom}{\abs{\partial_2\phi_3^{(n)}-ik\phi_2^{(n)}-v_1}^2}{\ddmes} &\rightarrow 0 \quad \toInfty{n}.
%\end{align*}
%Then changing variables via the map $r$ and noting \eqref{eq:PartialToTDiff-Vector},
%\begin{align*}
%	\int_0^{\abs{I_2}}\abs{\widetilde{\phi_j^{(n)}}-\widetilde{u_j}}^2 \md t \rightarrow 0 &\toInfty{n}, \ j =2,3 \\
%	\int_0^{\abs{I_2}}\abs{\widetilde{\partial_2\phi_3^{(n)}}-ik\widetilde{\phi_2^{(n)}}-\widetilde{v_1}}^2 \md t \rightarrow0 &\toInfty{n}
%\end{align*}
%But $\widetilde{\partial_2\phi_3^{(n)}} = \partial_t\widetilde{\phi_3^{(n)}}$, and thus we have the following convergences:
%\begin{align*}
%	\widetilde{\phi_2^{(n)}} &\lconv{\ltwo{\sqbracs{0,\abs{I_2}}}{t}} \widetilde{u_2}, \\
%	\widetilde{\phi_3^{(n)}} &\lconv{\ltwo{\sqbracs{0,\abs{I_2}}}{t}} \widetilde{u_3}, \\
%	\partial_t\widetilde{\phi_3^{(n)}}-ik\widetilde{\phi_2^{(n)}} &\lconv{\ltwo{\sqbracs{0,\abs{I_2}}}{t}} \widetilde{v_1}.
%\end{align*}
%By the algebra of limits
%\begin{align*}
%	\widetilde{\phi_3^{(n)}} &\lconv{\ltwo{\sqbracs{0,\abs{I_2}}}{t}} \widetilde{u_3}, \\
%	\partial_t\widetilde{\phi_3^{(n)}} &\lconv{\ltwo{\sqbracs{0,\abs{I_2}}}{t}} ik\widetilde{u_2} + \widetilde{v_1}.
%\end{align*}
%Hence $\widetilde{u_3}\in\gradSob{\sqbracs{0,\abs{I_2}}}{t}$ and has distributional derivative $\widetilde{u_3}' = ik\widetilde{u_2} + \widetilde{v_1}$.
%Rearranging this means that 
%\begin{align*}
%\widetilde{v_1} &= \widetilde{u_3}' - ik\widetilde{u_2}.
%\end{align*}
%At this stage one should note the similarities between the form of $\widetilde{v_1}$ and the expression for the first component of the curl of a smooth vector field (after taking a Fourier transform in the $x_3$-direction).
%Thus 
%\begin{align*}
%	v_1 &= \widetilde{v_1}\circ r^{-1} \\
%	&= \widetilde{u_3}'\circ r^{-1} - iku_2.
%\end{align*}
%So we define
%\begin{align*}
%	u_3' := \widetilde{u_3}'\circ r^{-1},
%\end{align*}
%noting that, as in the scalar example (section \ref{sec:ScalarExample}), the prime notation here \textit{is only} notation and does not indicate that the function $u_3$ itself has any derivatives.
%However this notation provides the elegant looking form for the tangential $k$-curl;
%\begin{align*}
%	\kcurl{\ddmes}u &= \begin{pmatrix} u_3' - iku_2 \\ 0 \\ 0 \end{pmatrix}.
%\end{align*}
%
%\subsection{Reduction to Edge Equations}
%We now turn our attention back to consideration of \eqref{eq:CurlProblem} \tstk{fix this to match the equation that's introduced at the beginning of the section.} and seeking a method to determine the solution, either analytically or numerically.
%We seek solutions $\bracs{u,\kcurl{\ddmes}u}$ such that
%\begin{align*}
%	\integral{\ddom}{\bracs{\kcurl{\ddmes}u}\cdot\overline{\curl{k}\phi}}{\ddmes} &= \omega^2\integral{\ddom}{u\cdot\overline{\phi}}{\ddmes}, \quad \forall\phi .
%\end{align*}
%By following the method used in the analysis of section \ref{sec:TangKCurl}, we can obtain the edge equation for when $\ddmes$ supports a single edge parallel to the $x_2$ axis;
%\begin{align} \label{eq:OneEdge-EdgeEqn}
%	\integral{I_2}{\bracs{\widetilde{u}_3^{\prime}-ik\widetilde{u}_2}\bracs{\overline{\widetilde{\phi}}_3^{\prime}+ik\overline{\widetilde{\phi}}_2}}{t} &= \omega^2\integral{I_2}{\widetilde{u}_1\overline{\widetilde{\phi}} + \widetilde{u}_2\overline{\widetilde{\phi}}_2 + \widetilde{u}_3\overline{\widetilde{\phi}}_3}{t}.
%\end{align}
%In the general case when $\ddmes$ supports a graph $\graph$, we adopt a similar line of argument to the scalar example in section \ref{sec:ScalarExample}.
%First we break down \eqref{eq:CurlProblem} according to the properties of the measure $\ddmes$;
%\begin{align*}
%	0 &= \sum_{I_{ij}\in E} \integral{I_{ij}}{\bracs{\kcurl{\ddmes}u}\cdot\overline{\kcurl{}\phi}-\omega^2 u\cdot\overline{\phi}}{\lambda_{ij}}.
%\end{align*}
%Without loss of generality we can assume that each $I_{ij}$ is parallel to the $x_2$-axis, else we perform a rotation in the integral term involving $I_{ij}$ to obtain a transformed edge with this property, and we denote by $u_{ij}\in\ltwo{\ddom}{\lambda_{ij}}$ the function such that $u_{ij}=u$ on the (potentially rotated) edge $I_{ij}$.
%Again we think of $u_{ij}$ as the $ij$\textsuperscript{th}-part of $u$, or the part of $u$ down the edge $I_{ij}$.
%We reintroduce the maps $r_{ij}:\sqbracs{0,\abs{I_{ij}}}\rightarrow I_{ij}$ from section \ref{sec:ScalarReduceEdgeEqns} to aid in our analysis.
%Also note that (similar to the scalar-gradient case) we require the information about $\kcurlZero{\ddom}{\lambda_{ij}}$ to perform any of the rotations mentioned above, and retain equivalence of the resulting problem to the original.\newline
%
%As before (section \ref{sec:ScalarExample}), we begin by rewriting \eqref{eq:VectorExampleWeakForm} by appealing to the nature of $\ddmes$;
%\begin{align} \label{eq:VectorExampleSumOfInts}
%	0 &= \sum_{I_{ij}\in E}\integral{\ddom}{\bracs{\kcurl{\ddmes}u_{ij}}\cdot\overline{\bracs{\kcurl{}\phi}} - \omega^2 u_{ij}\cdot\overline{\phi}}{\lambda_{ij}}.
%\end{align}
%Then we focus our attention to each of the terms
%\begin{align*}
%	\integral{\ddom}{\bracs{\kcurl{\ddmes}u_{ij}}\cdot\overline{\bracs{\kcurl{}\phi}} - \omega^2 u_{ij}\cdot\overline{\phi}}{\lambda_{ij}}.
%\end{align*}
%We know that the solution to \eqref{eq:VectorExampleWeakForm} satisfies $\kcurl{\ddmes} u \perp \kcurlZero{\ddom}{\ddmes}$ and so $\kcurl{\ddmes} u_{ij} \perp \kcurlZero{\ddom}{\lambda_{ij}}$ by our analysis of $k$-curls of zero.
%In light of the analysis of section \ref{sec:TangKCurl} we conclude that
%\begin{align*}
%	\integral{\ddom}{\bracs{\kcurl{\ddmes}u_{ij}}\cdot\overline{\bracs{\kcurl{}\phi}} - \omega^2 u_{ij}\cdot\overline{\phi}}{\lambda_{ij}}
%	&= \int_0^{\abs{I_{ij}}} \bracs{\widetilde{u_{ij}^{(3)}}' - ik\widetilde{u_{ij}^{(2)}}}\overline{\bracs{\widetilde{\phi_3}' - ik\widetilde{\phi_2}}} \\
%	&\quad- \omega^2\widetilde{u_{ij}}\cdot\widetilde{\phi} \md t \\
%	&= \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(1)}}\widetilde{\phi_1} \md t \\
%	&+ \int_0^{\abs{I_{ij}}} \bracs{\omega^2\widetilde{u_{ij}^{(2)}} - ik\widetilde{u_{ij}^{(3)}}' - k^2\widetilde{u_{ij}^{(2)}}}\widetilde{\phi_2} \md t \\
%	&+ \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(3)}}\widetilde{\phi_3} + \bracs{ik\widetilde{u_{ij}^{(2)}} - \widetilde{u_{ij}^{(3)}}'}\widetilde{\phi_3}' \md t
%\end{align*}
%This is effectively a system of 3 equations in the components $\widetilde{u_{ij}^{(1)}},\widetilde{u_{ij}^{(2)}},\widetilde{u_{ij}^{(3)}}$ as equality holds for arbitrary (smooth) $\phi$.
%Note that the component $\widetilde{u_{ij}^{(1)}}$ is always equal to the zero function which is to be expected given the characterisation of $k$-curls of zero and that we have rotated $I_{ij}$ to be parallel to the $x_2$-axis.
%Of course, once we undo any rotations we have performed we will obtain a solution with non-zero first component.
%All this means that \eqref{VectorExampleWeakForm} is equivalent to solving the system
%\begin{subequations} \label{eq:VectorExampleWeakSystem-3Eqns}
%	\begin{align}
%		0 &= \sum_{I_{ij}\in E} \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(1)}}\widetilde{\phi_1} \md t \\
%		0 &= \sum_{I_{ij}\in E} \int_0^{\abs{I_{ij}}} \bracs{\omega^2\widetilde{u_{ij}^{(2)}} - ik\widetilde{u_{ij}^{(3)}}' - k^2\widetilde{u_{ij}^{(2)}}}\widetilde{\phi_2} \md t \\
%		0 &= \sum_{I_{ij}\in E} \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(3)}}\widetilde{\phi_3} + \bracs{ik\widetilde{u_{ij}^{(2)}} - \widetilde{u_{ij}^{(3)}}'}\widetilde{\phi_3}' \md t.
%	\end{align}
%\end{subequations}
%
%Whilst the forms above are useful for numerical approaches, under stronger regularity assumptions on $u$ we can obtain a system of classical ODEs which will admit analytic analysis.
%\tstk{check regularity that's needed. As $C^1$ for example means that we also need continuity of $\widetilde{u_{ij}^{(2)}}'$ at the vertices ON TOP OF the Kirchoff condition we get...}
%To this end we assume at least $C^1$ regularity of $u_{ij}^{(2)}$ and $C^2$ regularity of $u_{ij}^{(2)}$, then note that \eqref{eq:VectorExampleWeakSystem-3Eqns} must hold whenever $\supp\bracs{\phi}$ intersects (the interior of) precisely one edge $I_{ij}$.
%In this case the sum in \eqref{eq:VectorExampleWeakSystem-3Eqns} collapses and we can manipulate the equation involving $\widetilde{\phi_3}$ by integrating by parts;
%\begin{align*}
%	0 &= \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(3)}}\widetilde{\phi_3} + \bracs{ik\widetilde{u_{ij}^{(2)}} - \widetilde{u_{ij}^{(3)}}'}\widetilde{\phi_3}' \md t \\
%	&= \int_0^{\abs{I_{ij}}} \bracs{\omega^2\widetilde{u_{ij}^{(3)}} - ik\widetilde{u_{ij}^{(2)}}' + \widetilde{u_{ij}^{(3)}}''}\widetilde{\phi_3} \md t.
%\end{align*}
%Then as each component of $\widetilde{\phi}$ is smooth and arbitrary on $I_{ij}$, we conclude that the following equations hold on $I_{ij}$;
%\begin{align*}
%	0 &= \omega^2\widetilde{u_{ij}^{(1)}}\widetilde{\phi_1}, \quad \implies \widetilde{u_{ij}^{(1)}}=0, \\
%	ik\widetilde{u_{ij}^{(3)}}' &= \bracs{\omega^2-k^2}\widetilde{u_{ij}^{(2)}}, \\
%	ik\widetilde{u_{ij}^{(2)}}' &= \widetilde{u_{ij}^{(3)}}'' + \omega^2\widetilde{u_{ij}^{(3)}}.
%\end{align*}
%In particular $\widetilde{u_{ij}^{(2)}}$ and $\widetilde{u_{ij}^{(3)}}$ satisfy a system of coupled ODEs on $I_{ij}$.
%As the edge we elected to examine was arbitrary, we have a system of such ODEs on each of the edges of $\graph$.
%To obtain the boundary conditions for this system we consider the implications of $\supp\bracs{\phi}$ containing precisely one vertex $v_i\in V$.
%The regularity we have assumed for the components of $\widetilde{u}$ means that we must have continuity (matching) of $\widetilde{u_{ij}^{(2)}}$ and $\widetilde{u_{ij}^{(3)}}$ at each vertex $v_i$.
%This gives us two boundary conditions per vertex; to determine the remaining condition notice that
%\begin{align*}
%	\int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(3)}}\widetilde{\phi_3} + \bracs{ik\widetilde{u_{ij}^{(2)}} - \widetilde{u_{ij}^{(3)}}'}\widetilde{\phi_3}' \md t 
%	&= \int_0^{\abs{I_{ij}}} \bracs{\omega^2\widetilde{u_{ij}^{(3)}} - ik\widetilde{u_{ij}^{(2)}}'  + \widetilde{u_{ij}^{(3)}}''}\widetilde{\phi_3} \md t \\
%	&\quad + \widetilde{\phi_3}\vert_{v_i}\sqbracs{ik\widetilde{u_{ij}^{(2)}}-\widetilde{u_{ij}^{(3)}}'}\vert_{v_i} \\
%	&= \widetilde{\phi_3}\vert_{v_i}\sqbracs{ik\widetilde{u_{ij}^{(2)}}-\widetilde{u_{ij}^{(3)}}'}\vert_{v_i}.
%\end{align*}
%Hence
%\begin{align*}
%	0 &= \sum_{I_{ij}\in E} \int_0^{\abs{I_{ij}}} \omega^2\widetilde{u_{ij}^{(3)}}\widetilde{\phi_3} + \bracs{ik\widetilde{u_{ij}^{(2)}} - \widetilde{u_{ij}^{(3)}}'}\widetilde{\phi_3}' \md t, \\
%	\Rightarrow 0 &= \sum_{i\sim j} \widetilde{\phi_3}\vert_{v_i}\sqbracs{ik\widetilde{u_{ij}^{(2)}}-\widetilde{u_{ij}^{(3)}}'}\vert_{v_i}, \\
%	\Rightarrow 0 &= \sum_{i\sim j} \sqbracs{ik\widetilde{u_{ij}^{(2)}}-\widetilde{u_{ij}^{(3)}}'}\vert_{v_i}.
%\end{align*}
%This gives us a matching condition at each of the vertices of $\graph$; notice that unlike in the scalar-gradient example (section \ref{sec:ScalarExample}) we do not obtain a Kirchoff condition at the vertices.
%In summary, additional regularity of $u$ provides us with the following system of equations:
%\begin{subequations} \label{eq:VectorEdgeEquationsSystem}
%	\begin{align}
%		\widetilde{u_{ij}^{(1)}} &= 0, \\
%		ik\widetilde{u_{ij}^{(3)}}' &= \bracs{\omega^2-k^2}\widetilde{u_{ij}^{(2)}}, \\
%		ik\widetilde{u_{ij}^{(2)}}' &= \widetilde{u_{ij}^{(3)}}'' + \omega^2\widetilde{u_{ij}^{(3)}}, \\
%		\widetilde{u^{(2)}}, \widetilde{u^{(3)}} &\text{ are continuous at each vertex } v_i\in V, \\
%		0 &= \sum_{i\sim j} \sqbracs{ik\widetilde{u_{ij}^{(2)}}-\widetilde{u_{ij}^{(3)}}'}\vert_{v_i} \quad \forall v_i\in V.
%	\end{align}
%\end{subequations}